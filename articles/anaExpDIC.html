<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Análise de Experimentos em Delineamento Inteiramente Casualizado • labestData</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">labestData</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/index.html">Vinhetas</a>
</li>
<li>
  <a href="../reference/index.html">Datasets</a>
</li>
<li>
  <a href="../reference/index.html">Funções</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Análise de Experimentos em Delineamento Inteiramente Casualizado</h1>
                        <h4 class="author">PET Estatística UFPR</h4>
            
          </div>

    
    
<div class="contents">
<div id="analise-exploratoria" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#analise-exploratoria" class="anchor"> </a></body></html>Análise exploratória</h2>
<p>Nessa <em>vignette</em> vamos considerar <code>BanzattoQd3.2.1</code>, já disponível no pacote <a href="https://gitlab.c3sl.ufpr.br/pet-estatistica/labestData"><strong>labestData</strong></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(labestData)
## ls("package:labestData")</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(BanzattoQd3<span class="fl">.2.1</span>, <span class="dt">help_type =</span> <span class="st">"html"</span>)</code></pre></div>
<p>Este conjunto de dados é de um experimento instalado em delineamento inteiramente casualizado (DIC) para estudar diferentes produtos para controle de pulgão na cultura do pepino. Foram avaliados 4 produtos (<code>trat</code>), e mais uma testemunha, para controle do pulgão (<em>Aphis gossypii</em> Glover). A variável resposta desse experimento foi o número de pulgões encontrados, uma variável resposta do tipo contagem.</p>
<p>Em caso de não ter o pacote <strong>labestData</strong>, você pode ler a tabela de dados diretamente do repositório. No entanto, recomendamos que instale o pacote para ter acesso a todos os datasets e às documentações</p>
<p>Antes de iniciar a análise dos dados do experimento, é muito recomendável fazer uma análise exploratória que serve basicamente para</p>
<ul>
<li>Verificar se os dados não possuem erros de digitação;</li>
<li>Antecipar a presença de observações discrepantes (outliers);</li>
<li>Verificar as escalas das variáveis;</li>
<li>Antecipar a existência de efeito dos fatores estudados;</li>
<li>Compreender os dados.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-----------------------------------------------------------------------</span>
<span class="co"># Ler a partir do repositório do labestData.</span>

<span class="co"># url &lt;- paste0("https://gitlab.c3sl.ufpr.br/pet-estatistica",</span>
<span class="co">#               "/labestData/raw/devel/data-raw/BanzattoQd3.2.1.txt")</span>
<span class="co">#</span>
<span class="co"># BanzattoQd3.2.1 &lt;-</span>
<span class="co">#     read.table(file = url, sep = "\t", header = TRUE,</span>
<span class="co">#                colClasses = c("factor", "integer", "integer"))</span>

<span class="co">#-----------------------------------------------------------------------</span>
<span class="co"># Análise exploratória.</span>

<span class="co"># Estrutura do objeto.</span>
<span class="kw">str</span>(BanzattoQd3<span class="fl">.2.1</span>)</code></pre></div>
<pre><code>## 'data.frame':    30 obs. of  3 variables:
##  $ trat   : Factor w/ 5 levels "Azinfos etilico",..: 5 1 3 4 2 5 1 3 4 2 ...
##  $ rept   : int  1 1 1 1 1 2 2 2 2 2 ...
##  $ pulgoes: int  2370 1282 562 173 193 1687 1527 321 127 71 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Tabela de frequência para os tratamentos.</span>
<span class="kw">xtabs</span>(~trat, <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>)</code></pre></div>
<pre><code>## trat
##      Azinfos etilico        Diazinon 60CE Supracid 40CE dose 1 
##                    6                    6                    6 
## Supracid 40CE dose 2           Testemunha 
##                    6                    6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Dados desemplilhados.</span>
<span class="kw">t</span>(<span class="kw">unstack</span>(<span class="dt">x =</span> BanzattoQd3<span class="fl">.2.1</span>, <span class="dt">form =</span> pulgoes ~<span class="st"> </span>trat))</code></pre></div>
<pre><code>##                      [,1] [,2] [,3] [,4] [,5] [,6]
## Azinfos.etilico      1282 1527  871 1025  825  920
## Diazinon.60CE         193   71   82   62   96   44
## Supracid.40CE.dose.1  562  321  636  317  485  842
## Supracid.40CE.dose.2  173  127  132  150  129  227
## Testemunha           2370 1687 2592 2283 2910 3020</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Média e desvio-padrão das observações em cada nível.</span>
<span class="kw">aggregate</span>(pulgoes ~<span class="st"> </span>trat,  <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>,
          <span class="dt">FUN =</span> function(y) {
              <span class="kw">c</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(y), <span class="dt">dp =</span> <span class="kw">sd</span>(y))
          })</code></pre></div>
<pre><code>##                   trat pulgoes.mean pulgoes.dp
## 1      Azinfos etilico   1075.00000  274.87961
## 2        Diazinon 60CE     91.33333   52.83812
## 3 Supracid 40CE dose 1    527.16667  200.31517
## 4 Supracid 40CE dose 2    156.33333   38.75908
## 5           Testemunha   2477.00000  483.47658</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">packageVersion</span>(<span class="st">"lattice"</span>)</code></pre></div>
<pre><code>## [1] '0.20.34'</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Diagrama de dispersão.</span>
<span class="kw">xyplot</span>(pulgoes ~<span class="st"> </span><span class="kw">reorder</span>(trat, pulgoes), <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>,
       <span class="dt">xlab =</span> <span class="st">"Produtos para controle de pulgão"</span>,
       <span class="dt">ylab =</span> <span class="st">"Número de pulgões 36hs após pulverização"</span>,
       <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">90</span>)))</code></pre></div>
<p><img src="anaExpDIC_files/figure-html/unnamed-chunk-3-1.png" width="600" style="display: block; margin: auto;"></p>
<p>Pela análise exploratória temos que esse experimento é balanceado pois tem número igual de repetições de cada produto. O diagrama de dispersão mostra os valores observados do número de pulgões em função dos produtos. Os níveis foram ordenados de acordo com os números médios de pulgões. É imediato perceber a partir do gráfico que a variabilidade do número de pulgões aumenta com a média. Isso é importante porque adianta um possível problema com o pressuposto de homogeneidade de variâncias do modelo.</p>
</div>
<div id="especificacao-e-ajuste-do-modelo" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#especificacao-e-ajuste-do-modelo" class="anchor"> </a></body></html>Especificação e ajuste do modelo</h2>
<p>O modelo estatístico correspondente ao delineamento é</p>
<p><span class="math display">\[
\begin{aligned}
  Y|\text{produtos} &amp;\,\sim \text{Normal}(\mu_i, \sigma^2) \newline
  \mu_i &amp;= \mu+\tau_i
\end{aligned}
\]</span></p>
<p>em que <span class="math inline">\(\tau_i\)</span> é o efeito do produto <span class="math inline">\(i\)</span> sobre a variável resposta <span class="math inline">\(Y\)</span>, <span class="math inline">\(\mu\)</span> é a média de <span class="math inline">\(Y\)</span> na ausência do efeito dos produtos, <span class="math inline">\(\mu_i\)</span> é a média para cada nível de produto e <span class="math inline">\(\sigma^2\)</span> é a variância das observações ao redor desse valor médio (ou variância residual).</p>
<p>Para fazer a estimação desses parâmetros é necessário que seja considerada alguma restrição paramétrica. Para isso, no R por default considera-se o efeito do primeiro nível como zero (<span class="math inline">\(\tau_1 = 0\)</span>). É possível mudar isso nas opções de contrastes do R. Outra parametrização, bem conhecida e usada, é a retrição do tipo soma zero dos efeitos (<span class="math inline">\(\sum \tau_i = 0\)</span>) e, para essa situação, <span class="math inline">\(\mu\)</span> representa a média geral do experimento.</p>
<p>Existem duas funções no R para ajustar esse modelo: <code>lm()</code> e <code>aov()</code>. Embora muitos acreditem que <code>aov()</code> deva ser preferida, por causa do nome AOV (<em>Analysis Of Variance</em>), a função <code>lm()</code> é tão apropriada quanto. Inclusive, objetos vindos da <code>lm()</code> dispõem de mais métodos que a da <code>aov()</code> em pacotes para fazer comparações múltiplas, por exemplo. Sendo assim, vamos usar a <code>lm()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-----------------------------------------------------------------------</span>
<span class="co"># Ajuste do modelo.</span>

m0 &lt;-<span class="st"> </span><span class="kw">lm</span>(pulgoes ~<span class="st"> </span>trat, <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>)

<span class="co"># Estimativas dos efeitos. Restrição de zerar primeiro nível.</span>
<span class="kw">cbind</span>(<span class="kw">coef</span>(m0))</code></pre></div>
<pre><code>##                               [,1]
## (Intercept)              1075.0000
## tratDiazinon 60CE        -983.6667
## tratSupracid 40CE dose 1 -547.8333
## tratSupracid 40CE dose 2 -918.6667
## tratTestemunha           1402.0000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Matriz de contrastes sob a retrição zerar primeiro nível.</span>
K &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, <span class="kw">contrasts</span>(BanzattoQd3<span class="fl">.2.1</span>$trat))
K</code></pre></div>
<pre><code>##                        Diazinon 60CE Supracid 40CE dose 1
## Azinfos etilico      1             0                    0
## Diazinon 60CE        1             1                    0
## Supracid 40CE dose 1 1             0                    1
## Supracid 40CE dose 2 1             0                    0
## Testemunha           1             0                    0
##                      Supracid 40CE dose 2 Testemunha
## Azinfos etilico                         0          0
## Diazinon 60CE                           0          0
## Supracid 40CE dose 1                    0          0
## Supracid 40CE dose 2                    1          0
## Testemunha                              0          1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Médias estimadas pelo modelo.</span>
K %*%<span class="st"> </span><span class="kw">coef</span>(m0)</code></pre></div>
<pre><code>##                            [,1]
## Azinfos etilico      1075.00000
## Diazinon 60CE          91.33333
## Supracid 40CE dose 1  527.16667
## Supracid 40CE dose 2  156.33333
## Testemunha           2477.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Médias amostrais.</span>
<span class="kw">aggregate</span>(pulgoes ~<span class="st"> </span>trat, <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>, <span class="dt">FUN =</span> mean)</code></pre></div>
<pre><code>##                   trat    pulgoes
## 1      Azinfos etilico 1075.00000
## 2        Diazinon 60CE   91.33333
## 3 Supracid 40CE dose 1  527.16667
## 4 Supracid 40CE dose 2  156.33333
## 5           Testemunha 2477.00000</code></pre>
<p>Conforme comentado, devido à restrição usada, os coeficientes estimados não são as médias em cada nível. Para a restrição do primeiro nível ter efeito nulo, o coeficiente <code>(Intercept)</code> é a média do primeiro nível, no caso <code>Azinfos etilico</code>. Os demais coeficientes são estimativas dos constrastes entre médias de cada um dos níveis restantes com relação ao primeiro nível.</p>
<p>Como nesse exemplo existe uma testemunha, seria conveniente que a testemunha fosse o primeiro nível para então termos os contrastes como resultado do ajuste do modelo. No entanto, como a testemunha é o último nível, pode-se mudar o tipo de contraste para <code>contr.SAS</code>, cuja restrição é zerar o efeito do último nível. Na sequência temos os resultados das duas opções.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">update</span>(m0, <span class="dt">contrasts =</span> <span class="kw">list</span>(<span class="dt">trat =</span> <span class="st">"contr.SAS"</span>))
<span class="kw">coef</span>(m1)</code></pre></div>
<pre><code>##              (Intercept)      tratAzinfos etilico 
##                 2477.000                -1402.000 
##        tratDiazinon 60CE tratSupracid 40CE dose 1 
##                -2385.667                -1949.833 
## tratSupracid 40CE dose 2 
##                -2320.667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BanzattoQd3<span class="fl">.2.1</span> &lt;-<span class="st"> </span><span class="kw">transform</span>(BanzattoQd3<span class="fl">.2.1</span>,
                             <span class="dt">trat =</span> <span class="kw">relevel</span>(trat, <span class="dt">ref =</span> <span class="st">"Testemunha"</span>))

<span class="kw">levels</span>(BanzattoQd3<span class="fl">.2.1</span>$trat)</code></pre></div>
<pre><code>## [1] "Testemunha"           "Azinfos etilico"     
## [3] "Diazinon 60CE"        "Supracid 40CE dose 1"
## [5] "Supracid 40CE dose 2"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m0 &lt;-<span class="st"> </span><span class="kw">update</span>(m0,  <span class="dt">data =</span> BanzattoQd3<span class="fl">.2.1</span>)
<span class="kw">coef</span>(m0)</code></pre></div>
<pre><code>##              (Intercept)      tratAzinfos etilico 
##                 2477.000                -1402.000 
##        tratDiazinon 60CE tratSupracid 40CE dose 1 
##                -2385.667                -1949.833 
## tratSupracid 40CE dose 2 
##                -2320.667</code></pre>
</div>
<div id="avaliacao-dos-pressupostos" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#avaliacao-dos-pressupostos" class="anchor"> </a></body></html>Avaliação dos pressupostos</h2>
<p>Para fazer inferência a partir do modelo ajustado aos dados, é necessário verificar se os pressupostos do modelo foram atendidos. Caso não sejam, as inferências produzidas não são fiéis, pois a distribuição amostral das estatísticas de teste não são as mesmas sob violação dos pressupostos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-----------------------------------------------------------------------</span>
<span class="co"># Exibe o quarteto fantástico da avaliação dos pressupostos.</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(m0); <span class="kw">layout</span>(<span class="dv">1</span>)</code></pre></div>
<p><img src="anaExpDIC_files/figure-html/unnamed-chunk-6-1.png" width="600" style="display: block; margin: auto;"></p>
<p>O conjunto de gráficos acima exibe fuga dos pressupostos. A suposição de homogeneidade de variâncias é claramente violada. Vemos o padrão cone no gráfico 1-1 dessa matriz (<em>Residuals vs Fitted</em>). No gráfico 2-1 (<em>Scale-Location</em>), temos ênfase desse padrão porque a linha média mostra uma relação positiva com a dispersão, representada pela raíz dos valores absolutos dos resíduos padronizados, versus os valores ajustados (média). Ou seja, a relação média-variância não é nula, pois se fosse, a linha de tendência seria horizontal. Por fim, o gráfico 1-2 (Normal Q-Q), exibe fuga do pressuposto de normalidade dos erros, influenciada pela relação média-variância.</p>
<p>Da forma como está, o modelo não tem os pressupostos atendidos. Logo não é recomendado fazer inferências. Precisamos remediar a fuga dos pressupostos antes e a opção mais comum é procurar uma tranformação que estabilize a variância. Em casos como esse, as transformações do tipo potência são capazes de estabilizar a variância. Vamos considerar a transformação Box-Cox para isso.</p>
<p>A tranformação Box-Cox baseia-se na escolha do valor <span class="math inline">\(\lambda\)</span> de tal maneira que se aumente a compatibilidade dos dados com a suposição de normalidade. A transformação aplicada aos dados é</p>
<p><span class="math display">\[
\begin{aligned}
  y_{\text{transformado}} &amp;=
    \frac{y^{\lambda}-1}{\lambda}, \quad \text{ se }
    \lambda\neq 0 \newline
  y_{\text{transformado}} &amp;= \log(y), \quad \text{ se } \lambda=0.
\end{aligned}
\]</span></p>
<p>A transformação só pode ser aplicada para respostas positivas, <span class="math inline">\(y&gt;0\)</span> . Caso tenha-se zeros ou valores negativos podemos somar uma constante aos dados. Como o que interessa da transformação é parte não linear (a potenciação), na prática apenas se aplica a função potência sem subtrair 1 e dividir por <span class="math inline">\(\lambda\)</span>. No entanto, essa é a transformação de fato aplicada para calcular o valor da log-verossimilhança. Se houver a curiosidade de fazer o cálculo da log-verrossimilhança passo a passo, lembre-se de considerar o jacobiano da transformação.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MASS::<span class="kw">boxcox</span>(m0)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>/<span class="dv">3</span>), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="anaExpDIC_files/figure-html/unnamed-chunk-7-1.png" width="600" style="display: block; margin: auto;"></p>
<p>A função perfil de log-verossilhança em <span class="math inline">\(\lambda\)</span> tem intervalo de confiança (95%) que inclui os valores 0 e 1/3, correspondentes às transformações log e raíz cúbica, respectivamente. Não há necessidade de usar o valor exato correspondente ao máximo da função porque isso não vai mudar a normalidade da variável transformada e, como o valor exato é um valor quebrado, valores de <span class="math inline">\(\lambda\)</span> que correspondem a transformações conhecidas são convenientes, como log, raíz quadrada e raíz cúbica.</p>
<p>Encontrada a transformação a ser aplicada, devemos ajustar o modelo com a variável transformada e avaliar novamente os pressupostos. Não existe garantia de qua a transformação irá corrigir a fuga. O que ela faz é remediar o problema, mas o resultado pode ainda não ser satisfatório.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Atualiza o modelo anterior passando o log na resposta.</span>
m0 &lt;-<span class="st"> </span><span class="kw">update</span>(m0, <span class="kw">log</span>(.) ~<span class="st"> </span>.)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(m0); <span class="kw">layout</span>(<span class="dv">1</span>)</code></pre></div>
<p><img src="anaExpDIC_files/figure-html/unnamed-chunk-8-1.png" width="600" style="display: block; margin: auto;"></p>
<p>Note agora que os gráficos não exibem padrões de fuga de pressupostos. Pelo gráfico 2-1, a relação média variância agora está estável (ou nula). Não há fugas de normalidade de acordo com o gráfico 1-2. Portanto, foi bem sucedida a aplicação da transformação log ao número de pulgões para que o modelo tivesse os pressupostos atendidos. Agora é possível proceder com as inferências.</p>
</div>
<div id="inferencias" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#inferencias" class="anchor"> </a></body></html>Inferências</h2>
<p>O objetivo de ter feito o experimento é saber se existe efeito dos produtos para o controle do pulgão na cultura do pepino. Ou seja, se o número médio de pulgões muda conforme o produto aplicado.</p>
<p>O efeito dos produtos é representado pelos coeficientes <span class="math inline">\(\tau_i\)</span> no modelo estatístico do experimento. Se não existir efeito dos produtos, os valores estimados para <span class="math inline">\(\tau_{i}\)</span> serão próximos a zero. A hipóteses nula de não haver efeito dos produtos é representada por</p>
<p><span class="math display">\[
  \text{H}_{0}: \tau_i = 0, \text{para todo}\,i.
\]</span></p>
<p>Essa hipótese é avaliada pelo estatística F do quadro de análise de variância.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(m0)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log(pulgoes)
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## trat       4 45.914 11.4786  103.93 3.381e-15 ***
## Residuals 25  2.761  0.1104                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Pelo quadro de anova (<em>analysis of variance</em>), temos que o valor da estatística F produziu um <span class="math inline">\(p\)</span>-valor bem pequeno, menor que qualquer nível de significancia adotado na prática. Dessa maneira, rejeitamos a hipótese nula de não haver efeito dos produtos no log do número de pulgões ou, por consequência, no número de pulgões.</p>
<p>Uma vez que existe efeito dos produtos, faz-se necessário aprofundar o conhecimento sobre eles. As hipóteses a serem testadas devem ser estabalecidas antes da coleta dos dados e ajuste do modelo. Como foram estudados 4 níveis de produto e uma testemunha, as hipóteses vão agora considerar diferenças entre cada produto e a testemunha. Como a testemunha é o primeiro nível, temos que testar as hipóteses individuais:</p>
<p><span class="math display">\[
  \text{H}_{0}: \mu_i - \mu_1 = 0, \text{para cada}\,i \neq 1.
\]</span></p>
<p>Da forma como ajustamos o modelo, temos as estimativas dos contrastes disponíveis no vetor de coeficientes. O teste individual para cada parâmetro é exibido com o <code>summary()</code> do modelo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(m0)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(pulgoes) ~ trat, data = BanzattoQd3.2.1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.61710 -0.18119 -0.02221  0.17473  0.86140 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                7.7973     0.1357  57.471  &lt; 2e-16 ***
## tratAzinfos etilico       -0.8424     0.1919  -4.391 0.000181 ***
## tratDiazinon 60CE         -3.3960     0.1919 -17.699 1.18e-15 ***
## tratSupracid 40CE dose 1  -1.5911     0.1919  -8.293 1.21e-08 ***
## tratSupracid 40CE dose 2  -2.7680     0.1919 -14.426 1.26e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3323 on 25 degrees of freedom
## Multiple R-squared:  0.9433, Adjusted R-squared:  0.9342 
## F-statistic: 103.9 on 4 and 25 DF,  p-value: 3.381e-15</code></pre>
<p>Na tabela dos coeficientes tem-se o valor t correspondente a cada contraste. O <code>(Intercept)</code> é a média do log do número de pulgões para a testemunha. Os demais representam contrastes dos produtos com relação à testemunha. Baseado nos <span class="math inline">\(p\)</span>-valores, todas as hipóteses de contraste nulo com a testemunha são rejeitadas. Ou seja, todos os produtos apresentam número médio diferente da testemunha, no caso um menor valor para média se comparado à testemunha.</p>
<p>Deve-se mencionar que se o nível de significância adotado é de 5% para cada teste. Assim, a probabilidade de rejeitar pelo menos uma hipótese é <span class="math inline">\(1 - (1 - 0,05)^{4} = 0.1854938\)</span>, ou seja, superior a 5%. Com o aumento do número de hipóteses testadas, é consequência aumentar o nível de significância global (probabilidade de rejeitar pelo menos uma hipótese). Existem diferentes formas de corrigir a elevação do nível global de significancia, mas esse não é um objetivo desta <em>vignette</em>.</p>
<p>Uma adequada representação dos resultados é um gráfico com os valores médios e intervalo de confiança para os níveis dos produtos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">trat =</span> <span class="kw">levels</span>(BanzattoQd3<span class="fl">.2.1</span>$trat))
pred &lt;-<span class="st"> </span><span class="kw">cbind</span>(pred,
              <span class="kw">as.data.frame</span>(<span class="kw">predict</span>(m0,
                                    <span class="dt">newdata =</span> pred,
                                    <span class="dt">interval =</span> <span class="st">"confidence"</span>)))
pred$trat &lt;-<span class="st"> </span><span class="kw">reorder</span>(pred$trat, pred$fit)
<span class="kw">head</span>(pred)</code></pre></div>
<pre><code>##                   trat      fit      lwr      upr
## 1           Testemunha 7.797284 7.517859 8.076709
## 2      Azinfos etilico 6.954847 6.675423 7.234272
## 3        Diazinon 60CE 4.401294 4.121869 4.680718
## 4 Supracid 40CE dose 1 6.206162 5.926737 6.485587
## 5 Supracid 40CE dose 2 5.029280 4.749855 5.308704</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(latticeExtra)

<span class="kw">segplot</span>(trat ~<span class="st"> </span>lwr +<span class="st"> </span>upr, <span class="dt">centers =</span> fit, <span class="dt">data =</span> pred,
        <span class="dt">draw =</span> <span class="ot">FALSE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>,
        <span class="dt">xlab =</span> <span class="st">"Produtos para controle de pulgão"</span>,
        <span class="dt">ylab =</span> <span class="st">"Log do número de pulgões"</span>,
        <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">90</span>)),
        <span class="dt">panel =</span> function(x, y, z, centers, ...) {
            <span class="kw">panel.segplot</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z, <span class="dt">centers =</span> centers, ...)
            <span class="kw">panel.text</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(z), <span class="dt">y =</span> centers,
                       <span class="dt">label =</span> <span class="kw">sprintf</span>(<span class="st">"%0.2f"</span>, centers),
                       <span class="dt">srt =</span> <span class="dv">90</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, -<span class="fl">0.5</span>))
    })</code></pre></div>
<p><img src="anaExpDIC_files/figure-html/unnamed-chunk-12-1.png" width="600" style="display: block; margin: auto;"></p>
</div>
<div id="gerando-experimento-em-dic" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#gerando-experimento-em-dic" class="anchor"> </a></body></html>Gerando experimento em DIC</h2>
<p>É simples produzir o plano de um delineamento inteiramente casualizado. Vamos gerar o plano para executar um experimento semelhante ao apresentado, mas com 8 repetições e mais um produto, o <code>Novo</code> produto.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="kw">levels</span>(BanzattoQd3<span class="fl">.2.1</span>$trat), <span class="st">"Novo"</span>),
            <span class="dt">times =</span> <span class="dv">8</span>)

<span class="co"># Opção 1: sorteie os níveis para as unidades experimentais ordenadas.</span>
<span class="kw">data.frame</span>(<span class="dt">trat =</span> <span class="kw">sample</span>(trat), <span class="dt">ue =</span> <span class="dv">1</span>:<span class="kw">length</span>(trat))

<span class="co"># Opção 2: sorteie as unidades experimentais ordenadas para os níveis.</span>
<span class="kw">data.frame</span>(<span class="dt">trat =</span> trat, <span class="dt">ue =</span> <span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">length</span>(trat)))</code></pre></div>
</div>
<div id="informacoes-da-sessao" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#informacoes-da-sessao" class="anchor"> </a></body></html>Informações da sessão</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.3.2 (2016-10-31)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu precise (12.04.5 LTS)
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets 
## [7] base     
## 
## other attached packages:
##  [1] multcomp_1.4-6       TH.data_1.0-8        MASS_7.3-45         
##  [4] survival_2.39-5      mvtnorm_1.0-6        knitr_1.15.1        
##  [7] vcd_1.4-3            reshape_0.8.6        car_2.1-4           
## [10] qcc_2.6              reshape2_1.4.2       ggplot2_2.2.1       
## [13] latticeExtra_0.6-28  RColorBrewer_1.1-2   lattice_0.20-34     
## [16] labestData_0.1-1.462
## 
## loaded via a namespace (and not attached):
##  [1] zoo_1.7-14         purrr_0.2.2        splines_3.3.2     
##  [4] colorspace_1.3-2   htmltools_0.3.5    yaml_2.1.14       
##  [7] mgcv_1.8-15        pkgdown_0.1.0.9000 nloptr_1.0.4      
## [10] withr_1.0.2        plyr_1.8.4         stringr_1.2.0     
## [13] MatrixModels_0.4-1 munsell_0.4.3      commonmark_1.2    
## [16] gtable_0.2.0       devtools_1.12.0    codetools_0.2-15  
## [19] memoise_1.0.0      evaluate_0.10      labeling_0.3      
## [22] SparseM_1.76       highlight_0.4.7    lmtest_0.9-35     
## [25] quantreg_5.29      pbkrtest_0.4-6     parallel_3.3.2    
## [28] methods_3.3.2      Rcpp_0.12.9        scales_0.4.1      
## [31] backports_1.0.5    desc_1.1.0         pkgload_0.0.0.9000
## [34] lme4_1.1-12        digest_0.6.12      stringi_1.1.2     
## [37] rprojroot_1.2      tools_3.3.2        sandwich_2.3-4    
## [40] magrittr_1.5       lazyeval_0.2.0     tibble_1.2        
## [43] crayon_1.3.2       whisker_0.3-2      Matrix_1.2-7.1    
## [46] xml2_1.1.1         assertthat_0.1     minqa_1.2.4       
## [49] rmarkdown_1.3.9004 roxygen2_6.0.1     R6_2.2.0          
## [52] nnet_7.3-12        nlme_3.1-128</code></pre>
<!------------------------------------------- -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#analise-exploratoria">Análise exploratória</a></li>
      <li><a href="#especificacao-e-ajuste-do-modelo">Especificação e ajuste do modelo</a></li>
      <li><a href="#avaliacao-dos-pressupostos">Avaliação dos pressupostos</a></li>
      <li><a href="#inferencias">Inferências</a></li>
      <li><a href="#gerando-experimento-em-dic">Gerando experimento em DIC</a></li>
      <li><a href="#informacoes-da-sessao">Informações da sessão</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by PET Estatística UFPR.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
